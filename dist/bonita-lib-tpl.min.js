angular.module("bonitable",[]).controller("BonitableController",["$scope",function(t){function e(t){return t.isChecked()}function n(t){return t.data}this.getOptions=function(){return t.sortOptions},this.triggerSortHandler=function(e){t.onSort({options:e})};var r=[];this.registerSelector=function(t){r.push(t)},this.unregisterSelector=function(t){var e=r.indexOf(t);r=r.slice(0,e).concat(r.slice(e+1))};var o={$selectedItems:function(){return r.filter(e).map(n)},$allSelected:function(){return this.$selectedItems.length===r.length},$indeterminate:function(){return this.$selectedItems.length!==r.length&&this.$selectedItems.length>0}};this.prepareScope=function(t){Object.keys(o).forEach(function(t){Object.defineProperty(this,t,{get:o[t],enumerable:!0,iterable:!0})},t),t.$toggleAll=function(){var t=!this.$allSelected;r.forEach(function(e){e.setChecked(t)})}}}]).directive("bonitable",function(){return{priority:100,scope:{onSort:"&",sortOptions:"=",repeatableConfig:"="},transclude:"element",controller:"BonitableController",compile:function(){return function(t,e,n,r,o){o(function(t,n){r.prepareScope(n),e.after(t)})}}}}),function(){"use strict";angular.module("org.bonita.services.topurl",[]).service("manageTopUrl",["$window",function(t){var e={};return e.getCurrentPageToken=function(){var e=/(^|[&\?])_p=([^&]*)(&|$)/,n=e.exec(t.top.location.hash);return n&&n.length?n[2]:""},e.addOrReplaceParam=function(n,r){if(void 0!==r&&t.self!==t.top){var o=e.getCurrentPageToken();if(t.top.location.hash){var i=new RegExp("(^|[&\\?])"+o+n+"=[^&]*(&|$)"),l=t.top.location.hash.match(i);if(l&&l.length){var a="";r&&(a=o+n+"="+r),t.top.location.hash=t.top.location.hash.replace(i,"$1"+a+"$2")}else{var s=t.top.location.hash;r&&(t.top.location.hash+=(s.indexOf("&",s.length-2)>=0?"":"&")+o+n+"="+r)}}else r&&(t.top.location.hash="#"+o+n+"="+r)}},e.getCurrentProfile=function(){if(t&&t.top&&t.top.location&&t.top.location.hash){var e=t.top.location.hash.match(/\b_pf=\d+\b/);return e&&e.length?e[0]:""}},e.getPath=function(){return t.top.location.pathname},e.getSearch=function(){return t.top.location.search||""},e.getUrlToTokenAndId=function(t,n){return e.getPath()+e.getSearch()+"#?id="+(t||"")+"&_p="+(n||"")+"&"+e.getCurrentProfile()},e}])}(),angular.module("bonita.sortable",[]).directive("boSorter",function(){return{restrict:"A",scope:!0,require:"^bonitable",templateUrl:"template/sortable/sorter.tpl.html",transclude:!0,link:function(t,e,n,r){t.property=(n.id||n.boSorter).trim(),t.sortOptions=r.getOptions(),t.sort=function(){t.sortOptions.property===t.property?t.sortOptions.direction=!t.sortOptions.direction:(t.sortOptions.property=t.property,t.sortOptions.direction=!1),r.triggerSortHandler(t.sortOptions)}}}}),angular.module("bonita.settings",["ui.bootstrap.dropdown","ui.bootstrap.buttons"]).directive("tableSettings",function(){return{templateUrl:"template/table-settings/tableSettings.tpl.html",replace:!0,scope:{columns:"=",sizes:"=",pageSize:"=",labelProp:"@",visibleProp:"@",updatePageSize:"&",updateVisibility:"&"},link:function(t,e,n){t.visible=n.visibleProp||"visible",t.label=n.labelProp||"name"}}}),angular.module("bonita.repeatable",[]).directive("columnTemplate",["$compile",function(t){return{restrict:"A",scope:{template:"=columnTemplate"},link:function(e,n){var r=angular.element(e.template),o=angular.element("<div></div>");angular.forEach(r[0].attributes,function(t){o.attr(t.name,r.attr(t.name))}),n.append(t(o.append(r.contents()))(e.$parent))}}}]).directive("boRepeatable",function(){return{require:"bonitable",restrict:"A",compile:function(t,e){function n(t){return null===t.th.getAttribute("data-ignore")}function r(t,e){return e[t]===!0}function o(t,e){var n=document.createElement(t);return n.setAttribute("column-template",e),n.setAttribute("ng-repeat","column in $columns | filter:$visibilityFilter"),n}var i=e[this.name]||"thead tr:last-child",l="tr[ng-repeat]",a=t[0].querySelector(i),s=t[0].querySelector(l);if(!a||!s||a.children.length!==s.children.length)throw new Error("bo-repeatable th number does not correspond to td number. please verify you html table");var c,u=[],p=s.children;[].some.call(a.children,function(t,e){return c=e,null===t.getAttribute("data-ignore")});var d=e.visibleProp||"visible";u=[].map.call(a.children,function(t,e){return{th:t,td:p[e]}}).filter(n).map(function(t){angular.element(t.th).remove(),angular.element(t.td).remove();var e={name:t.th.textContent,header:t.th.outerHTML,cell:t.td.outerHTML};return e[d]=!0,e});var b=o("th","column.header"),g=o("td","column.cell");return a.insertBefore(b,a.children[c]),s.insertBefore(g,s.children[c]),function(t){t.$columns=u,t.$visibilityFilter=r.bind(null,d)}}}}).directive("repeatableConfig",function(){return{priority:1,require:"bonitable",link:function(t,e,n){t.$watch(n.repeatableConfig,function(e){var r=n.visibleProp||"visible";if(e.length!==t.$columns.length)throw new Error("repeatable-config size differ from $columns size. Please check your config attr");t.$columns.forEach(function(t,n){t[r]=e[n]})})}}}),angular.module("bonita.selectable",[]).directive("boSelectall",function(){return{restrict:"A",require:"^bonitable",replace:!0,template:'<input type="checkbox" ng-checked="$allSelected" ng-click="$toggleAll()">',link:function(t,e){t.$watch(function(){return t.$indeterminate},function(t){e[0].indeterminate=t})}}}).directive("boSelector",function(){return{restrict:"A",require:"^bonitable",link:function(t,e,n,r){function o(){t.$apply()}function i(){r.unregisterSelector(a)}var l=e.controller("ngModel"),a={data:t.$eval(n.boSelector),isChecked:function(){return l&&l.$modelValue===!0||e[0].checked},setChecked:function(t){l?(l.$setViewValue(t===!0),l.$render()):e[0].checked=t}};e.on("change",o),t.$on("$destroy",i),r.registerSelector(a)}}}),function(t){try{t=angular.module("bonita.templates")}catch(e){t=angular.module("bonita.templates",[])}t.run(["$templateCache",function(t){t.put("template/table-settings/tableSettings.tpl.html",'<div class="btn-group pull-right" dropdown>\n  <button type="button"\n    id="aria-tablesettings"\n    class="btn btn-default bo-Settings dropdown-toggle"\n    title="{{\'Table settings\' | translate}}"\n    ng-disabled="tasks.length === 0"\n    aria-labelledby="aria-tablesettings">\n    <i class="icon icon-gear"></i>\n    <span class="sr-only">{{\'Table settings\' | translate}}</span>\n  </button>\n\n  <div class="TableSettings dropdown-menu pull-right" role="menu" aria-labelledby="aria-tablesettings">\n    <h5 class="TableSettings-title" >{{\'Items per page \'| translate}}</h5>\n    <div class="btn-group TableSettings-pagesizes">\n      <button class="btn btn-default"\n        type="button"\n        style="width:{{100/sizes.length}}%"\n        ng-repeat="size in sizes"\n        ng-model="$parent.pageSize" btn-radio="{{size}}"\n        ng-change="updatePageSize({size:size})" tabindex="0">\n        {{size}}\n      </button>\n    </div>\n\n    <h5 class="TableSettings-title" >{{\'Columns Selection\' | translate}}</h5>\n    <ul class="TableSettings-Columns">\n      <li  ng-repeat="field in columns">\n      <label\n        class="ColumnsItem"\n        title="{{(field.selected ? \'Hide\' : \'Show\') +\' \'+ field[label] }}"\n        ng-click="$event.stopPropagation()">\n        <input type="checkbox" ng-model="field[visible]" ng-change="updateVisibility({field:field})">\n        {{field[label]}}\n      </label>\n      </li>\n    </ul>\n  </div>\n</div>\n')}])}(),function(t){try{t=angular.module("bonita.templates")}catch(e){t=angular.module("bonita.templates",[])}t.run(["$templateCache",function(t){t.put("template/sortable/sorter.tpl.html","<button class=\"SortButton\"\n        title=\"{{'Sort by ' + sortLabel + (sortOptions.property === property ? (sortOptions.direction? ' ASC': ' DESC') : ' DESC') }}\"\n        ng-class=\"{'SortButton--active':sortOptions.property === property}\" ng-click=\"sort()\">\n  <span class=\"SortButton-label\" ng-transclude></span>\n  <i class=\"SortButton-icon\" ng-class=\"{'icon-sort-up': !sortOptions.direction || sortOptions.property !== property, 'icon-sort-down': sortOptions.direction && sortOptions.property === property}\"></i>\n</button>\n")}])}();