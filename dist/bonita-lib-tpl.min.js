angular.module("bonita.ui",["bonitable","bonita.templates","bonita.sortable","bonita.selectable","bonita.repeatable","bonita.settings"]),angular.module("bonitable",[]).controller("BonitableController",["$scope",function(t){function e(t){return t.isChecked()}function n(t){return t.data}this.getOptions=function(){return t.sortOptions},this.triggerSortHandler=function(e){t.onSort({options:e})};var i=[];this.registerSelector=function(t){i.push(t)};var r={$selectedItems:function(){return i.filter(e).map(n)},$allSelected:function(){return this.$selectedItems.length===i.length},$indeterminate:function(){return this.$selectedItems.length!==i.length&&this.$selectedItems.length>0}};this.prepareScope=function(t){Object.keys(r).forEach(function(t){Object.defineProperty(this,t,{get:r[t],enumerable:!0,iterable:!0})},t),t.$toggleAll=function(){var t=!this.$allSelected;i.forEach(function(e){e.setChecked(t)})}}}]).directive("bonitable",function(){return{priority:100,scope:{onSort:"&",sortOptions:"=",repeatableConfig:"="},transclude:"element",controller:"BonitableController",compile:function(){return function(t,e,n,i,r){r(function(t,n){i.prepareScope(n),e.after(t)})}}}}),angular.module("bonita.selectable",[]).directive("boSelectall",function(){return{restrict:"A",require:"^bonitable",replace:!0,template:'<input type="checkbox" ng-checked="$allSelected" ng-click="$toggleAll()">',link:function(t,e){t.$watch(function(){return t.$indeterminate},function(t){e[0].indeterminate=t})}}}).directive("boSelector",function(){return{restrict:"A",require:"^bonitable",link:function(t,e,n,i){function r(){t.$apply()}var l=e.controller("ngModel"),o={data:t.$eval(n.boSelector),isChecked:function(){return l&&l.$modelValue===!0||e[0].checked},setChecked:function(t){l?(l.$setViewValue(t===!0),l.$render()):e[0].checked=t}};e.on("change",r),i.registerSelector(o)}}}),angular.module("bonita.settings",["ui.bootstrap.dropdown","ui.bootstrap.buttons"]).directive("tableSettings",function(){return{templateUrl:"template/table-settings/tableSettings.tpl.html",replace:!0,scope:{columns:"=",sizes:"=",pageSize:"=",labelProp:"@",visibleProp:"@",updatePageSize:"&",updateVisibility:"&"},link:function(t,e,n){t.visible=n.visibleProp||"visible",t.label=n.labelProp||"id"}}}),angular.module("bonita.sortable",[]).directive("boSorter",function(){return{restrict:"A",scope:!0,require:"^bonitable",templateUrl:"template/sortable/sorter.tpl.html",transclude:!0,link:function(t,e,n,i){t.property=(n.id||n.boSorter).trim(),t.sortOptions=i.getOptions(),t.sort=function(){t.sortOptions.property===t.property?t.sortOptions.direction=!t.sortOptions.direction:(t.sortOptions.property=t.property,t.sortOptions.direction=!1),i.triggerSortHandler(t.sortOptions)}}}}),angular.module("bonita.repeatable",[]).directive("columnTemplate",["$compile",function(t){return{restrict:"A",scope:{template:"=columnTemplate"},link:function(e,n){var i=angular.element(e.template),r=angular.element("<div></div>");angular.forEach(i[0].attributes,function(t){r.attr(t.name,i.attr(t.name))}),n.append(t(r.append(i.contents()))(e.$parent))}}}]).directive("boRepeatable",function(){return{require:"bonitable",restrict:"A",compile:function(t,e){function n(t){return null===t.th.getAttribute("data-ignore")}function i(t,e){return e[t]===!0}var r=e[this.name]||"thead tr:last-child",l="tr[ng-repeat]",o=t[0].querySelector(r),a=t[0].querySelector(l);if(!o||!a||o.children.length!==a.children.length)throw new Error("bo-repeatable th number does not correspond to td number. please verify you html table");var s=[],c=a.children,u=e.visibleProp||"visible";return s=[].map.call(o.children,function(t,e){return{th:t,td:c[e]}}).filter(n).map(function(t){angular.element(t.th).remove(),angular.element(t.td).remove();var e={name:t.th.textContent,header:t.th.outerHTML,cell:t.td.outerHTML};return e[u]=!0,e}),angular.element(o).append('<th column-template="column.header" ng-repeat="column in $columns | filter:$visibilityFilter"></th>'),angular.element(a).append('<td column-template="column.cell" ng-repeat="column in $columns | filter:$visibilityFilter"></td>'),function(t){t.$columns=s,t.$visibilityFilter=i.bind(null,u)}}}}).directive("repeatableConfig",function(){return{priority:1,require:"bonitable",link:function(t,e,n){t.$watch(n.repeatableConfig,function(e){var i=n.visibleProp||"visible";if(e.length!==t.$columns.length)throw new Error("repeatable-config size differ from $columns size. Please check your config attr");t.$columns.forEach(function(t,n){t[i]=e[n]})})}}}),function(t){try{t=angular.module("bonita.templates")}catch(e){t=angular.module("bonita.templates",[])}t.run(["$templateCache",function(t){t.put("template/sortable/sorter.tpl.html","<button class=\"SortButton\"\n        title=\"{{'Sort by ' + sortLabel + (sortOptions.property === property ? (sortOptions.direction? ' ASC': ' DESC') : ' DESC') }}\"\n        ng-class=\"{'SortButton--active':sortOptions.property === property}\" ng-click=\"sort()\">\n  <span class=\"SortButton-label\" ng-transclude></span>\n  <i class=\"SortButton-icon\" ng-class=\"{'icon-sort-up': !sortOptions.direction || sortOptions.property !== property, 'icon-sort-down': sortOptions.direction && sortOptions.property === property}\"></i>\n</button>\n")}])}(),function(t){try{t=angular.module("bonita.templates")}catch(e){t=angular.module("bonita.templates",[])}t.run(["$templateCache",function(t){t.put("template/table-settings/tableSettings.tpl.html",'<div class="btn-group pull-right" dropdown>\n  <button type="button btn-default"\n    id="aria-tablesettings"\n    class="btn dropdown-toggle"\n    title="{{\'Table settings\' | translate}}"\n    ng-disabled="tasks.length === 0"\n    aria-labelledby="aria-tablesettings">\n    <i class="icon icon-gear"></i>\n    <span class="sr-only">{{\'Table settings\' | translate}}</span>\n    <span class="caret"></span>\n  </button>\n\n  <div class="TableSettings dropdown-menu pull-right" role="menu" aria-labelledby="aria-tablesettings">\n    <h5 class="TableSettings-title" >{{\'Items per page \'| translate}}</h5>\n    <div class="btn-group TableSettings-pagesizes">\n      <button class="btn btn-default"\n        type="button"\n        style="width:{{100/sizes.length}}%"\n        ng-repeat="size in sizes"\n        ng-model="$parent.pageSize" btn-radio="{{size}}"\n        ng-change="updatePageSize({size:size})" tabindex="0">\n        {{size}}\n      </button>\n    </div>\n\n    <h5 class="TableSettings-title" >{{\'Columns Selection\' | translate}}</h5>\n    <ul class="TableSettings-Columns">\n      <li  ng-repeat="field in columns">\n      <label\n        class="ColumnsItem"\n        title="{{(field.selected ? \'Hide\' : \'Show\') +\' \'+ field[label] }}"\n        ng-click="$event.stopPropagation()">\n        <input type="checkbox" ng-model="field[visible]" ng-change="updateVisibility({field:field})">\n        {{field[label]}}\n      </label>\n      </li>\n    </ul>\n  </div>\n</div>\n')}])}();